import{u as ae,t as te}from"./calendarDays-BkJTnqQX.js";import{r as f,o as X,a,b as p,c as S,d as e,w as t,m as pe,u as ne,e as O,f as G,g as ee,h as H,F as q,i as Z,j as d,t as y,k as me,l as de,n as Q,p as ge,q as he}from"./index-ChbhjhMB.js";import{_ as xe,u as re,l as ye,a as Se,f as Fe}from"./food_base-Ck6sU6wh.js";const ke={__name:"SelectDate",setup(v){const{editTargetDate:F}=ae(),r=f(!1),_=f(new Date);function i(){F(_.value),r.value=!1}return X(()=>{F(_.value)}),(l,u)=>{const s=a("v-btn"),x=a("v-date-picker"),W=a("v-divider"),k=a("v-spacer"),C=a("v-card-actions"),M=a("v-card"),h=a("v-menu");return p(),S("div",null,[e(h,{location:"center",modelValue:r.value,"onUpdate:modelValue":u[1]||(u[1]=m=>r.value=m),"close-on-content-click":!1},{activator:t(({props:m})=>[e(s,pe({"prepend-icon":"$calendar",color:"white"},m,{text:_.value.toLocaleDateString()}),null,16,["text"])]),default:t(()=>[e(M,{"min-height":"300px"},{default:t(()=>[e(x,{modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=m=>_.value=m),"hide-header":""},null,8,["modelValue"]),e(W),e(C,null,{default:t(()=>[e(k),e(s,{color:"primary",variant:"text",text:"OK",onClick:i})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},be={key:0,class:"text-center"},Ce={__name:"FoodItem",props:{filteredFood:Array,loader:Boolean},emits:["updateSelectedFood"],setup(v,{emit:F}){const{name:r}=ne(),_=f(!1),i=f([]),l=f({}),u=f(100),s=v,x=O(()=>{switch(r.value){case"xs":return 280;case"sm":return 380;case"md":return 480;case"lg":return 580;case"xl":return 680;case"xxl":return 780;default:return 380}}),W=F;function k(o){_.value=!0,l.value=Object.assign({},o),l.value.productWeight?u.value=l.value.productWeight:u.value=100}function C(o){let n=o>0?o:100;s.filteredFood.forEach(g=>{g.id==l.value.id&&(l.value.calories=`${(+te(g.calories)*n/g.productWeight).toFixed(1).replace(/\.0$/,"")} кКал`,l.value.proteins=`${(+te(g.proteins)*n/g.productWeight).toFixed(1).replace(/\.0$/,"")} г`,l.value.fats=`${(+te(g.fats)*n/g.productWeight).toFixed(1).replace(/\.0$/,"")} г`,l.value.carbs=`${(+te(g.carbs)*n/g.productWeight).toFixed(1).replace(/\.0$/,"")} г`)})}function M(){s.filteredFood.forEach(o=>{o.id==l.value.id&&(o.calories=l.value.calories,o.proteins=l.value.proteins,o.fats=l.value.fats,o.carbs=l.value.carbs,o.productWeight=+u.value),m()}),l.value={},u.value=100,_.value=!1}function h(){l.value={},u.value=100,_.value=!1}function m(){i.value&&i.value.forEach(o=>{const n=s.filteredFood.find(g=>g.name===o.name);n&&(n.calories=o.calories,n.proteins=o.proteins,n.fats=o.fats,n.carbs=o.carbs,n.productWeight=o.productWeight)})}return G(i,()=>{localStorage.setItem("selectedFoodForMeal",JSON.stringify(i.value)),W("updateSelectedFood",i.value)}),X(()=>{localStorage.getItem("selectedFoodForMeal")&&(i.value=JSON.parse(localStorage.getItem("selectedFoodForMeal")),m())}),(o,n)=>{const g=a("v-progress-circular"),N=a("v-list-item-title"),L=a("v-list-item-subtitle"),E=a("v-list-item"),U=a("v-col"),A=a("v-checkbox"),j=a("v-row"),K=a("v-text-field"),B=a("v-card-item"),b=a("v-card-title"),D=a("v-card-text"),w=a("v-spacer"),I=a("v-btn"),T=a("v-card-actions"),c=a("v-card"),$=a("v-dialog"),Y=a("v-list");return p(),ee(Y,{lines:"one",height:x.value},{default:t(()=>[v.loader?(p(),S("div",be,[e(g,{indeterminate:""})])):H("",!0),(p(!0),S(q,null,Z(s.filteredFood,V=>(p(),ee(j,{"no-gutters":"",key:V.id,class:"hover-color",onClick:J=>k(V)},{default:t(()=>[e(U,null,{default:t(()=>[e(E,null,{default:t(()=>[e(N,null,{default:t(()=>[d(y(V.name),1)]),_:2},1024),e(L,null,{default:t(()=>[d(y(V.calories),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(U,{cols:"auto"},{default:t(()=>[e(A,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=J=>i.value=J),value:V,onClick:n[1]||(n[1]=me(()=>{},["stop"]))},null,8,["modelValue","value"])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e($,{"max-width":"800",modelValue:_.value,"onUpdate:modelValue":n[3]||(n[3]=V=>_.value=V)},{default:t(()=>[e(c,{title:l.value.name},{default:t(()=>[e(B,null,{default:t(()=>[e(K,{"prepend-icon":"mdi-plus-minus-variant",type:"number",modelValue:u.value,"onUpdate:modelValue":[n[2]||(n[2]=V=>u.value=V),C]},null,8,["modelValue"])]),_:1}),e(j,{"no-gutters":"",class:"text-center"},{default:t(()=>[e(U,{class:"ma-1 bg-grey"},{default:t(()=>[e(B,null,{default:t(()=>[e(b,null,{default:t(()=>[d(" Калории ")]),_:1}),e(D,{class:"size-text"},{default:t(()=>[d(y(l.value.calories),1)]),_:1})]),_:1})]),_:1}),e(U,{class:"ma-1 bg-grey"},{default:t(()=>[e(B,null,{default:t(()=>[e(b,null,{default:t(()=>[d(" Белок ")]),_:1}),e(D,{class:"size-text"},{default:t(()=>[d(y(l.value.proteins),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{"no-gutters":"",class:"text-center"},{default:t(()=>[e(U,{class:"ma-1 bg-grey"},{default:t(()=>[e(B,null,{default:t(()=>[e(b,null,{default:t(()=>[d(" Жиры ")]),_:1}),e(D,{class:"size-text"},{default:t(()=>[d(y(l.value.fats),1)]),_:1})]),_:1})]),_:1}),e(U,{class:"ma-1 bg-grey"},{default:t(()=>[e(B,null,{default:t(()=>[e(b,null,{default:t(()=>[d(" Углеводы ")]),_:1}),e(D,{class:"size-text"},{default:t(()=>[d(y(l.value.carbs),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(w),e(I,{text:"Close",onClick:h}),e(I,{text:"Save",onClick:M})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1},8,["height"])}}},se=xe(Ce,[["__scopeId","data-v-6fc4dd9a"]]),De={__name:"MealComponent",props:{foodBase:Array},emits:["updateSelectedFood"],setup(v,{emit:F}){const{filterMyFoods:r}=re(),_=v,i=f(""),l=f([]),u=f(!1),s=f([]),x=f([]),W=F,k=o=>{u.value=!0,C(o)},C=ye.debounce(o=>{if(o){const n=M(o).map((N,L)=>({...N,productWeight:100,id:L+1})),g=r(o);s.value=[...g,...n],h(),localStorage.setItem("filteredFood",JSON.stringify([i.value,s.value])),u.value=!1}else s.value=[],u.value=!1},1e3);function M(o){return l.value.filter(n=>n.name.toLowerCase().includes(o.toLowerCase()))}function h(){x.value&&x.value.forEach(o=>{const n=s.value.find(g=>g.name===o.name);n&&(n.calories=o.calories,n.proteins=o.proteins,n.fats=o.fats,n.carbs=o.carbs,n.productWeight=o.productWeight)})}function m(o){x.value=o,W("updateSelectedFood",o,"MealComponent")}return G(x,()=>{h()}),X(()=>{l.value=_.foodBase,localStorage.getItem("filteredFood")&&(s.value=JSON.parse(localStorage.getItem("filteredFood"))[1],i.value=JSON.parse(localStorage.getItem("filteredFood"))[0])}),(o,n)=>{const g=a("v-text-field");return p(),S(q,null,[e(g,{block:"",label:"Введите продукт",variant:"solo-inverted","append-inner-icon":"mdi-magnify",type:"input",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=N=>i.value=N),onInput:n[1]||(n[1]=N=>k(N.target.value))},null,8,["modelValue"]),e(se,{filteredFood:s.value,loader:u.value,onUpdateSelectedFood:m},null,8,["filteredFood","loader"])],64)}}},ie=de("historyData",()=>{const v=f([]);function F(i){i.forEach(l=>{if(!v.value.some(s=>s.name===l.name))v.value.unshift(l);else{const s=v.value.find(x=>x.name===l.name);s&&(s.calories=l.calories,s.proteins=l.proteins,s.fats=l.fats,s.carbs=l.carbs,s.productWeight=l.productWeight,v.value.unshift(s),v.value=_(v.value))}}),localStorage.setItem("historyData",JSON.stringify(v.value))}function r(){return localStorage.getItem("historyData")&&(v.value=JSON.parse(localStorage.getItem("historyData"))),v.value}function _(i){return i.filter((l,u,s)=>u===s.findIndex(x=>x.name===l.name))}return{historyData:v,addProductInHostory:F,getHistoryData:r}}),we={key:0},$e={__name:"HistoryComponent",emits:["updateSelectedFood"],setup(v,{emit:F}){const{getHistoryData:r}=ie(),_=r(),i=F;function l(u){i("updateSelectedFood",u,"HistoryComponent")}return(u,s)=>(p(),S(q,null,[Q(_).length?H("",!0):(p(),S("div",we," История пуста ")),e(se,{filteredFood:Q(_),onUpdateSelectedFood:l},null,8,["filteredFood"])],64))}},Me={class:"text-center pa-1"},Ve={__name:"MyMealComponent",emits:["updateSelectedFood"],setup(v,{emit:F}){const{myFoods:r,getMyFoods:_,updateMyFood:i}=re(),l=f(!1),u=f(_()),s=F;function x(k){l.value=k}function W(k){s("updateSelectedFood",k,"MyMealComponent")}return G(r,()=>{u.value=_()}),X(()=>{localStorage.getItem("myFoods")&&(i(JSON.parse(localStorage.getItem("myFoods"))),u.value=_())}),(k,C)=>{const M=a("v-btn"),h=a("v-dialog");return p(),S("div",null,[ge("div",Me,[e(M,{color:"rgba(34, 139, 34, 0.7)",icon:"mdi-plus",size:"small",onClick:C[0]||(C[0]=m=>l.value=!0)})]),e(h,{width:"500",modelValue:l.value,"onUpdate:modelValue":C[1]||(C[1]=m=>l.value=m)},{default:t(()=>[e(Se,{onSetDialogAndFilteredFood:x})]),_:1},8,["modelValue"]),e(se,{filteredFood:u.value,onUpdateSelectedFood:W},null,8,["filteredFood"])])}}},Ie=de("selectedData",()=>{const v=f([]),F=f([]),r=f([]),_=f([]),i=f(0);function l(k,C){k&&(C==="MealComponent"?F.value=k:C==="HistoryComponent"?r.value=k:C==="MyMealComponent"&&(_.value=k)),v.value=[...F.value,...r.value,..._.value],v.value=v.value.filter((M,h,m)=>h===m.findIndex(o=>o.id===M.id&&o.name===M.name&&o.productWeight===M.productWeight))}function u(){return v.value}function s(){F.value=[],r.value=[],_.value=[],v.value=[]}function x(){return i.value=v.value.length,i.value}function W(){return i.value=0}return{addSelectedData:l,getSelectedData:u,clearSelectedData:s,getLengthSelectedData:x,clearLengthSelectedData:W}}),Ne={class:"text-center pa-2"},ze={key:0},We={key:1},Ue={key:2},Pe={__name:"MenuSelectFoods",props:{ration:Object},setup(v){const F=v,{getTargetDate:r,addNewDataInCalendar:_}=ae(),{addProductInHostory:i}=ie(),{addSelectedData:l,getSelectedData:u,clearSelectedData:s,getLengthSelectedData:x,clearLengthSelectedData:W}=Ie(),{name:k}=ne(),C={xs:{height:700,width:500},sm:{height:800,width:500},md:{height:900,width:550},lg:{height:1e3,width:650},xl:{height:1100,width:700},xxl:{height:1200,width:800}},M=O(()=>{var b;return(b=C[k.value])==null?void 0:b.height}),h=O(()=>{var b;return(b=C[k.value])==null?void 0:b.width}),m=f(!1),o=f(!0),n=f(!1),g=f(!1),N=f(0),L=f([]),E=f([]);function U(b){switch(b){case"meal":{o.value=!0,n.value=!1,g.value=!1;break}case"history":{o.value=!1,n.value=!0,g.value=!1;break}case"myMeal":{o.value=!1,n.value=!1,g.value=!0;break}}}function A(b,D){L.value=b,l(b,D),N.value=x()}function j(){_({date:r(),ration:F.ration,selectedFoods:u()}),i(L.value),B(),m.value=!1}function K(){B(),m.value=!1}function B(){s(),W(),localStorage.removeItem("filteredFood"),localStorage.removeItem("selectedFoodForMeal"),N.value=0}return X(()=>{E.value=Fe,B(),N.value=0}),(b,D)=>{const w=a("v-btn"),I=a("v-col"),T=a("v-icon"),c=a("v-badge"),$=a("v-row"),Y=a("v-card-title"),V=a("v-card-subtitle"),J=a("v-card-text"),oe=a("v-card"),le=a("v-overlay");return p(),S("div",Ne,[e(w,{color:"rgba(34, 139, 34, 0.7)",icon:"mdi-plus",size:"small",onClick:D[0]||(D[0]=R=>m.value=!0)}),e(le,{modelValue:m.value,"onUpdate:modelValue":D[4]||(D[4]=R=>m.value=R),width:h.value,class:"align-center justify-center","onClick:outside":K},{default:t(()=>[e(oe,{height:M.value},{actions:t(()=>[e(w,{text:"Назад",onClick:K}),e(w,{class:"ms-auto",text:"Ок",onClick:j})]),default:t(()=>[e(Y,null,{default:t(()=>[e($,null,{default:t(()=>[e(I,null,{default:t(()=>[d(y(Q(r)()),1)]),_:1}),e(I,{cols:"auto"},{default:t(()=>[e(c,{color:"info",inline:"",content:N.value},{default:t(()=>[e(T,{icon:"mdi-check",size:"x-large"})]),_:1},8,["content"])]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[d(y(v.ration.name),1)]),_:1}),e(J,{class:"pa-0"},{default:t(()=>[e($,{"text-align":"center",justify:"space-between",class:"d-flex flex-nowrap pa-4"},{default:t(()=>[e(I,null,{default:t(()=>[e(w,{stacked:"",width:"100%",height:"100%",density:"compact","prepend-icon":"mdi-silverware-fork-knife",class:"py-1",text:"Еда",onClick:D[1]||(D[1]=R=>U("meal"))})]),_:1}),e(I,null,{default:t(()=>[e(w,{stacked:"",width:"100%",height:"100%",density:"compact","prepend-icon":"mdi-history",class:"py-1",text:"История",onClick:D[2]||(D[2]=R=>U("history"))})]),_:1}),e(I,null,{default:t(()=>[e(w,{stacked:"",width:"100%",height:"100%",density:"compact","prepend-icon":"mdi-food-drumstick",class:"py-1",text:"Моя еда",onClick:D[3]||(D[3]=R=>U("myMeal"))})]),_:1})]),_:1}),e(J,null,{default:t(()=>[o.value?(p(),S("div",ze,[e(De,{foodBase:E.value,onUpdateSelectedFood:A},null,8,["foodBase"])])):H("",!0),n.value?(p(),S("div",We,[e($e,{onUpdateSelectedFood:A})])):H("",!0),g.value?(p(),S("div",Ue,[e(Ve,{onUpdateSelectedFood:A})])):H("",!0)]),_:1})]),_:1})]),_:1},8,["height"])]),_:1},8,["modelValue","width"])])}}},Oe=[{id:1,name:"Завтрак"},{id:2,name:"Обед"},{id:3,name:"Ужин"}],Be={class:"mx-auto"},He={key:0},Je={key:1},Le={key:2},Te={__name:"MainPage",setup(v){const{name:F}=ne(),{getPersonalization:r,updatePersonalization:_,setStatusMenuPersonalization:i}=he(),{calendarDays:l,getDataForDay:u,removePositionFromRation:s,calculateMyCalories:x,updateCalendarDays:W}=ae(),k=ae(),C=O(()=>F.value=="xs"),M=f([]),h=f(u()),m=f(0),o=O(()=>r().age),n=O(()=>r().height),g=O(()=>r().weight),N=O(()=>r().needingCalories),L=O(()=>r().activity),E=O(()=>x()),U=O(()=>r().needingCalories?`${E.value} / ${r().needingCalories}`:`${E.value}`),A=O(()=>r().age),j=function(){M.value=Oe};function K(){i(!0)}function B(w){switch(w){case 1:return b(h.value.breakfast);case 2:return b(h.value.lunch);case 3:return b(h.value.dinner)}}function b(w){return w?w.reduce((I,T)=>I+=D(T.calories),0).toFixed(1).replace(/\.0$/,""):0}function D(w){const I=w.replace(",",".").replace(/\s/g,"");return parseFloat(I)}return G(()=>k.dataForDay,w=>{h.value=w}),G(l,()=>{h.value=u()}),G(E,()=>{m.value=+x()*100/+r().needingCalories}),X(()=>{j(),localStorage.getItem("personalization")&&_(JSON.parse(localStorage.getItem("personalization"))),localStorage.getItem("calendarDays")&&(W(JSON.parse(localStorage.getItem("calendarDays"))),m.value=+x()*100/+r().needingCalories)}),(w,I)=>{const T=a("v-progress-linear"),c=a("v-col"),$=a("v-row"),Y=a("v-expansion-panel-title"),V=a("v-btn"),J=a("v-divider"),oe=a("v-expansion-panel-text"),le=a("v-expansion-panel"),R=a("v-expansion-panels"),ue=a("v-card"),_e=a("v-card-title"),ve=a("v-card-text"),fe=a("v-container");return p(),S("div",Be,[e(fe,null,{default:t(()=>[e($,null,{default:t(()=>[e(c,null,{default:t(()=>[e(ue,{"max-width":"800px","min-width":"300px","min-height":"500px",class:"mx-auto bg-grey-lighten-2",elevation:"4"},{default:t(()=>[e($,{"no-gutters":"",class:"d-flex align-center mb-3"},{default:t(()=>[e(c,{class:"d-flex flex-wrap"},{default:t(()=>[e(T,{rounded:"lg",class:"mx-auto ml-1",color:"#228B22",height:"30",modelValue:m.value,"onUpdate:modelValue":I[0]||(I[0]=P=>m.value=P)},{default:t(()=>[d(y(U.value),1)]),_:1},8,["modelValue"])]),_:1}),e(c,null,{default:t(()=>[e(ke,{class:"text-center align-center"})]),_:1}),C.value?H("",!0):(p(),ee(c,{key:0}))]),_:1}),e(R,null,{default:t(()=>[(p(!0),S(q,null,Z(M.value,P=>(p(),ee(le,{key:P.id},{default:t(()=>[e(Y,null,{default:t(()=>[e($,null,{default:t(()=>[e(c,{cols:"4"},{default:t(()=>[d(y(P.name),1)]),_:2},1024),e(c,{cols:"3"},{default:t(()=>[d(" кКал: ")]),_:1}),e(c,{cols:"3"},{default:t(()=>[d(y(B(P.id)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(oe,null,{default:t(()=>[e(Pe,{ration:P},null,8,["ration"]),P.id===1?(p(),S("div",He,[(p(!0),S(q,null,Z(h.value.breakfast,z=>(p(),S("div",{key:z.id},[e($,null,{default:t(()=>[e(c,{cols:"5"},{default:t(()=>[d(y(z.name),1)]),_:2},1024),e(c,{cols:"5"},{default:t(()=>[d(y(z.calories),1)]),_:2},1024),e(c,{cols:"auto"},{default:t(()=>[e(V,{variant:"text",density:"compact",icon:"mdi-close",onClick:ce=>Q(s)(h.value.date,P.id,z.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(J,{thickness:2,class:"mb-5"})]))),128))])):H("",!0),P.id===2?(p(),S("div",Je,[(p(!0),S(q,null,Z(h.value.lunch,z=>(p(),S("div",{key:z.id},[e($,null,{default:t(()=>[e(c,{cols:"5"},{default:t(()=>[d(y(z.name),1)]),_:2},1024),e(c,{cols:"5"},{default:t(()=>[d(y(z.calories),1)]),_:2},1024),e(c,{cols:"auto"},{default:t(()=>[e(V,{variant:"text",density:"compact",icon:"mdi-close",onClick:ce=>Q(s)(h.value.date,P.id,z.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(J,{thickness:2,class:"mb-5"})]))),128))])):H("",!0),P.id===3?(p(),S("div",Le,[(p(!0),S(q,null,Z(h.value.dinner,z=>(p(),S("div",{key:z.id},[e($,null,{default:t(()=>[e(c,{cols:"5"},{default:t(()=>[d(y(z.name),1)]),_:2},1024),e(c,{cols:"5"},{default:t(()=>[d(y(z.calories),1)]),_:2},1024),e(c,{cols:"auto"},{default:t(()=>[e(V,{variant:"text",density:"compact",icon:"mdi-close",onClick:ce=>Q(s)(h.value.date,P.id,z.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(J,{thickness:2,class:"mb-5"})]))),128))])):H("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(ue,{"max-width":"800px","min-width":"300px",class:"mx-auto bg-grey-lighten-2",elevation:"4"},{default:t(()=>[e(_e,null,{default:t(()=>[e($,null,{default:t(()=>[e(c,null,{default:t(()=>[d(" Ваши данные ")]),_:1}),e(c,{cols:"2"},{default:t(()=>[e(V,{size:"x-small",icon:"mdi-pencil",onClick:K})]),_:1})]),_:1})]),_:1}),A.value?(p(),ee(ve,{key:0},{default:t(()=>[e($,null,{default:t(()=>[e(c,null,{default:t(()=>[d(" Возраст: ")]),_:1}),e(c,null,{default:t(()=>[d(y(o.value),1)]),_:1})]),_:1}),e($,null,{default:t(()=>[e(c,null,{default:t(()=>[d(" Рост: ")]),_:1}),e(c,null,{default:t(()=>[d(y(n.value)+" см ",1)]),_:1})]),_:1}),e($,null,{default:t(()=>[e(c,null,{default:t(()=>[d(" Вес: ")]),_:1}),e(c,null,{default:t(()=>[d(y(g.value)+" кг ",1)]),_:1})]),_:1}),e($,null,{default:t(()=>[e(c,null,{default:t(()=>[d(" Дневная норма калорий: ")]),_:1}),e(c,null,{default:t(()=>[d(y(N.value)+" кКал ",1)]),_:1})]),_:1}),e($,null,{default:t(()=>[e(c,null,{default:t(()=>[d(" Активность: ")]),_:1}),e(c,null,{default:t(()=>[d(y(L.value),1)]),_:1})]),_:1})]),_:1})):H("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{Te as default};
